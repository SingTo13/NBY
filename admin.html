<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Admin Editor</title>
<style>
  body { font-family: sans-serif; display: flex; height: 100vh; margin: 0; }
  textarea { width: 40%; padding: 10px; }
  iframe { width: 60%; border: none; }
  button { padding: 10px; margin: 5px; }
</style>
</head>

<body>

<textarea id="editor">
<h1>‡∏™‡∏†‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h1>
<p>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ</p>
</textarea>

<div>
  <button onclick="save()">üíæ Save</button>
  <iframe id="preview"></iframe>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCe7iUd5wF9vh8wfbzcEgEkkTm9VLuRoDg",
  authDomain: "student-council-nby-2568.firebaseapp.com",
  projectId: "student-council-nby-2568",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const editor = document.getElementById("editor");
const preview = document.getElementById("preview");

function render() {
  preview.srcdoc = editor.value;
}
editor.addEventListener("input", render);
render();

// ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°
const ref = doc(db, "pages", "home");
const snap = await getDoc(ref);
if (snap.exists()) {
  editor.value = snap.data().html;
  render();
}

// save
window.save = async () => {
  await setDoc(ref, { html: editor.value });
  alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß");
};
</script>

</body>
</html>
